<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Exercises</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">PGR-LM</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="setup.html">
    <span class="fa fa-cog"></span>
     
    Setup
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    R Book
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://intro2r.com">
        <span class="fa fa-firefox"></span>
         
        Web book
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://github.com/alexd106/Rbook/raw/master/docs/Rbook.pdf">
        <span class="fa fa-file-pdf"></span>
         
        PDF book
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="exercises.html">
        <span class="fa fa-book"></span>
         
        Exercises
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="exercise_solutions.html">
        <span class="fa fa-book"></span>
         
        Exercise Solutions
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="data.html">
    <span class="fa fa-download"></span>
     
    Data
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-question-circle"></span>
     
    Info
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="syllabus.html">
        <span class="fa fa-graduation-cap"></span>
         
        Syllabus
      </a>
    </li>
    <li>
      <a href="People.html">
        <span class="fa fa-user-friends"></span>
         
        People
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="resources.html">
        <span class="fa fa-book"></span>
         
        Resources
      </a>
    </li>
    <li>
      <a href="https://forms.gle/TNV73wnSQAZ71p7U9">
        <span class="fa fa-commenting"></span>
         
        Feedback
      </a>
    </li>
    <li>
      <a href="People.html">
        <span class="fa fa-envelope fa-lg"></span>
         
        Contact
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://github.com/alexd106/PGR-LM">
        <span class="fa fa-github fa-lg"></span>
         
        Source code
      </a>
    </li>
    <li>
      <a href="https://twitter.com/Scedacity">
        <span class="fa fa-twitter fa-lg"></span>
         
        Twitter
      </a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Exercises</h1>

</div>


<p> </p>
<div id="linear-models---model-selection" class="section level2">
<h2>Linear models - Model selection</h2>
<p> </p>
<p>In the previous exercise you fitted a pre-conceived model which
included the main effects of the area of the forest patch
(<code>LOGAREA</code>), the grazing intensity (<code>FGRAZE</code>) and
the interaction between these two explanatory variables
(<code>FGRAZE:LOGAREA</code>). This was useful as a training exercise,
and might be a viable approach when analysing these data if an
experiment had been designed to test these effects only. However, if
other potentially important variables are not included in the model this
may lead to biased inferences (interpretation). Additionally, if the
goal of the analysis is to explore what models explain the data in a
parsimonious way (as opposed to formally testing hypotheses), we would
also want to include relevant additional explanatory variables.</p>
<p> </p>
<p>Here we revisit the previous loyn data analysis, and ask if a
‘better’ model for these data could be achieved by including additional
explanatory variables and by performing model selection. Because we
would like to test the significance of the interaction between
<code>LOGAREA</code>, and <code>FGRAZE</code>, whilst accounting for the
potential effects of other explanatory variables, we will also include
<code>LOGAREA</code>, <code>FGRAZE</code> and their interaction
(<code>FGRAZE:LOGAREA</code>) in the model as before. Including other
interaction terms between other variables may be reasonable, but we will
focus only on the <code>FGRAZE:LOGAREA</code> interaction as we have
relatively little information in this data set (67 observations). This
will hopefully avoid fitting an overly complex model which will estimate
many parameters for which we have very little data. This is a balance
you will all have to maintain with your own data and analyses (or better
still, perform a power analysis before you even collect your data). No
4-way interaction terms in your models please!</p>
<p> </p>
<p>It’s also important to note that we will assume that all the
explanatory variables were collected by the researchers because <em>they
believed</em> them to be biologically relevant for explaining bird
abundance (i.e. data were collected for a reason). Of course, this is
probably not your area of expertise but it is nevertheless a good idea
to pause and think what might be relevant or not-so relevant and why.
This highlights the importance of knowing your study organism / study
area and discussing research designs with colleagues and other experts
in the field before you collect your data. What you should try to avoid
is collecting heaps of data across many variables (just because you can)
and then expecting your statistical models to make sense of it for you.
As mentioned in the lecture, model selection is a relatively
controversial topic and should not be treated as a purely mechanical
process (chuck everything in and see what comes out). Your expertise
needs to be woven into this process otherwise you may end up with a
model that is implausible or not very useful (and all models need to be
useful!).</p>
<p> </p>
<p>1. Import the ‘loyn.txt’ data file into RStudio and assign it to a
variable called <code>loyn</code>. Here we will be using all the
explanatory variables to explain the variation in bird density. If
needed, remind yourself of your data exploration you conducted
previously. Do any of the remaining variables need transforming
(i.e. <code>AREA</code>, <code>DIST</code>, <code>LDIST</code>) or
converting to a factor type variable (i.e. <code>GRAZE</code>)? Add the
transformed variables to the <code>loyn</code> dataframe.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>loyn <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data/loyn.txt&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">str</span>(loyn)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="do">## &#39;data.frame&#39;:    67 obs. of  8 variables:</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="do">##  $ SITE   : int  1 60 2 3 61 4 5 6 7 8 ...</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="do">##  $ ABUND  : num  5.3 10 2 1.5 13 17.1 13.8 14.1 3.8 2.2 ...</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="do">##  $ AREA   : num  0.1 0.2 0.5 0.5 0.6 1 1 1 1 1 ...</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="do">##  $ DIST   : int  39 142 234 104 191 66 246 234 467 284 ...</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="do">##  $ LDIST  : int  39 142 234 311 357 66 246 285 467 1829 ...</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="do">##  $ YR.ISOL: int  1968 1961 1920 1900 1957 1966 1918 1965 1955 1920 ...</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="do">##  $ GRAZE  : int  2 2 5 5 2 3 5 3 5 5 ...</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="do">##  $ ALT    : int  160 180 60 140 185 160 140 130 90 60 ...</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>loyn<span class="sc">$</span>LOGAREA <span class="ot">&lt;-</span> <span class="fu">log10</span>(loyn<span class="sc">$</span>AREA)</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>loyn<span class="sc">$</span>LOGDIST <span class="ot">&lt;-</span> <span class="fu">log10</span>(loyn<span class="sc">$</span>DIST)</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>loyn<span class="sc">$</span>LOGLDIST <span class="ot">&lt;-</span> <span class="fu">log10</span>(loyn<span class="sc">$</span>LDIST)</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="co"># create factor GRAZE as it was originally coded as an integer</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>loyn<span class="sc">$</span>FGRAZE <span class="ot">&lt;-</span> <span class="fu">factor</span>(loyn<span class="sc">$</span>GRAZE)</span></code></pre></div>
<p> </p>
<p>2. Let’s start with a very quick graphical exploration of any
potential relationships between each explanatory variable (collinearity)
and also between our response and explanatory variables (what we’re
interested in). Create a pairs plot using the function
<code>pairs()</code>of your variables of interest. Hint: restrict the
plot to the variables you actually need. An effective way of doing this
is to store the names of the variables of interest in a vector
<code>VOI &lt;- c("Var1", "Var2", ...)</code> and then use the naming
method for subsetting the data set <code>Mydata[, VOI]</code>. If you
feel like it, you can also add the correlations to the lower triangle of
the plot as you did previously (don’t forget to define the function
first).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># define the panel.cor function from ?pairs</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>panel.cor <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">prefix =</span> <span class="st">&quot;&quot;</span>, cex.cor, ...)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>{</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>    usr <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="st">&quot;usr&quot;</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">usr =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">cor</span>(x, y))</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    txt <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">c</span>(r, <span class="fl">0.123456789</span>), <span class="at">digits =</span> digits)[<span class="dv">1</span>]</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>    txt <span class="ot">&lt;-</span> <span class="fu">paste0</span>(prefix, txt)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">missing</span>(cex.cor)) cex.cor <span class="ot">&lt;-</span> <span class="fl">0.8</span><span class="sc">/</span><span class="fu">strwidth</span>(txt)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>    <span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="at">cex =</span> cex.cor <span class="sc">*</span> r)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>}</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co"># subset the variables of interest</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>VOI<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ABUND&quot;</span>, <span class="st">&quot;LOGAREA&quot;</span>, <span class="st">&quot;LOGDIST&quot;</span>, <span class="st">&quot;LOGLDIST&quot;</span>, <span class="st">&quot;YR.ISOL&quot;</span>, <span class="st">&quot;ALT&quot;</span>, <span class="st">&quot;FGRAZE&quot;</span>)</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="fu">pairs</span>(loyn[, VOI], <span class="at">lower.panel =</span> panel.cor)</span></code></pre></div>
<p><img src="linear_model_4_exercise_solutions_files/figure-html/Q2-1.png" width="672" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co"># There are varying degrees of correlation between explanatory variables which</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co"># might indicate some collinearity, i.e. LOGAREA and FGRAZE (0.48), LOGDIST and </span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># LOGLDIST (0.59) and YR.ISOL and FGRAZE (0.56). However, the relationships</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co"># between these explanatory variables are quite weak so we can probably </span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co"># include these variables in the same model (but keep an eye on things). </span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co"># There also seems to be a reasonable spread of observations across these </span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co"># pairs of explanatory variables which is a good thing.</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co"># The relationship between the response variable ABUND and all the explanatory</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co"># variables is visible in the top row:</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co"># Some potential relationships present like with LOGAREA (positive), </span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co"># maybe ALT (positive) and FGRAZE (negative).</span></span></code></pre></div>
<p> </p>
<p>3. Now, let’s fit our maximal model. Start with a model of
<code>ABUND</code> and include all explanatory variables as main
effects. Also include the interaction <code>LOGAREA:FGRAZE</code> but no
other interaction terms as justified in the preamble above. Don’t forget
to include the transformed versions of the variables where appropriate
(but not the untransformed variables as well otherwise you will have
very strong collinearity between these variables!). Perhaps, call this
model <code>M1</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ABUND <span class="sc">~</span> LOGDIST <span class="sc">+</span> LOGLDIST <span class="sc">+</span> YR.ISOL <span class="sc">+</span> ALT <span class="sc">+</span> LOGAREA <span class="sc">+</span> FGRAZE <span class="sc">+</span> </span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>           FGRAZE<span class="sc">:</span>LOGAREA, <span class="at">data =</span> loyn)</span></code></pre></div>
<p> </p>
<p>4. Have a look at the summary table of the model using the
<code>summary()</code> function. You’ll probably find this summary is
quite complicated with lots of parameter estimates (14) and P values
testing lots of hypotheses. Are all the P values less than our cut-off
of 0.05? If not, then this suggests that some form of model selection is
warranted to simplify our model.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">summary</span>(M1)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="do">## lm(formula = ABUND ~ LOGDIST + LOGLDIST + YR.ISOL + ALT + LOGAREA + </span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="do">##     FGRAZE + FGRAZE:LOGAREA, data = loyn)</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="do">##     Min      1Q  Median      3Q     Max </span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="do">## -14.976  -1.972   0.142   2.388  10.631 </span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="do">##                   Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="do">## (Intercept)      33.963217  93.824477   0.362  0.71880   </span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="do">## LOGDIST           0.882214   2.204341   0.400  0.69061   </span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="do">## LOGLDIST         -0.253543   1.709295  -0.148  0.88264   </span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="do">## YR.ISOL          -0.008283   0.047374  -0.175  0.86186   </span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="do">## ALT               0.016979   0.018630   0.911  0.36622   </span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="do">## LOGAREA           3.733668   1.914379   1.950  0.05643 . </span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="do">## FGRAZE2          -6.757424   4.132084  -1.635  0.10790   </span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="do">## FGRAZE3         -12.488020   4.542801  -2.749  0.00816 **</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="do">## FGRAZE4         -16.133695   4.838990  -3.334  0.00157 **</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="do">## FGRAZE5         -17.191221   4.991340  -3.444  0.00113 **</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="do">## LOGAREA:FGRAZE2   4.877440   2.565757   1.901  0.06275 . </span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="do">## LOGAREA:FGRAZE3   9.410212   3.223378   2.919  0.00514 **</span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="do">## LOGAREA:FGRAZE4  14.166912   4.304081   3.292  0.00178 **</span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="do">## LOGAREA:FGRAZE5   2.617845   3.347001   0.782  0.43761   </span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a><span class="do">## Residual standard error: 5.009 on 53 degrees of freedom</span></span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.8034, Adjusted R-squared:  0.7551 </span></span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a><span class="do">## F-statistic: 16.66 on 13 and 53 DF,  p-value: 2.644e-14</span></span></code></pre></div>
<p> </p>
<p>5. Let’s perform a first step in model selection using the
<code>drop1()</code> function and use an <em>F</em> test based model
selection approach. This will allow us to decide which explanatory
variables may be suitable for removal from the model. Remember to use
the <code>test = "F"</code> argument to perform <em>F</em> tests when
using <code>drop1()</code>. Which explanatory variable is the best
candidate for removal and why?</p>
<p>What hypothesis is being tested when we do this model selection
step?</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Wait: why can&#39;t we use information from the &#39;summary(M1)&#39; or &#39;anova(M1)&#39; functions</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co"># to do this?</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co"># the &#39;summary&#39; table tests if the coefficient for each explanatory variable </span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co"># is significantly different from zero.</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co"># the &#39;anova&#39; tests for the significance of the proportion of variation explained</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co"># by a particular term in the model. </span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co"># The ANOVA table also allows testing the overall significance of a categorical explanatory</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co"># variable (like FGRAZE) which involves several parameters together (one for each level), </span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co"># which is quite is handy. But the results of this ANOVA are based on sequential </span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co"># sums of squares and therefore the order of the variables in the model</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co"># (which is arbitrary here) matters.</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co"># We could change the order but there are too many possible permutations.</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co"># Summary P values don&#39;t suffer from this problem but tests different hypotheses.</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co"># It would be useful to use an ANOVA that doesn&#39;t depend on the order</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co"># of inclusion of the variables, this is effectively what &#39;drop1&#39; does.</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="fu">drop1</span>(M1, <span class="at">test =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="do">## Single term deletions</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="do">## Model:</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="do">## ABUND ~ LOGDIST + LOGLDIST + YR.ISOL + ALT + LOGAREA + FGRAZE + </span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="do">##     FGRAZE:LOGAREA</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="do">##                Df Sum of Sq    RSS    AIC F value   Pr(&gt;F)   </span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="do">## &lt;none&gt;                      1329.8 228.20                    </span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="do">## LOGDIST         1      4.02 1333.8 226.40  0.1602 0.690605   </span></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="do">## LOGLDIST        1      0.55 1330.3 226.23  0.0220 0.882644   </span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a><span class="do">## YR.ISOL         1      0.77 1330.6 226.24  0.0306 0.861862   </span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="do">## ALT             1     20.84 1350.6 227.24  0.8306 0.366220   </span></span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a><span class="do">## LOGAREA:FGRAZE  4    405.04 1734.8 238.02  4.0358 0.006259 **</span></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a></span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a><span class="co"># LOGLDIST is the least significant (p = 0.88), and therefore makes the least </span></span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a><span class="co"># contribution to the variability explained by the model, with respect to </span></span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a><span class="co"># the number of degrees of freedom it uses (1). This variable is a good candidate </span></span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a><span class="co"># to remove from the model </span></span></code></pre></div>
<p> </p>
<p>6. Update and refit your model and remove the least significant
explanatory variable (from above). Repeat single term deletions with
<code>drop1()</code> again using this updated model. You can update the
model by just fitting a new model without the appropriate explanatory
variable and assign it to a new name (<code>M2</code>). Alternatively
you can use the <code>update()</code> function instead (I show you how
to do this in the solutions).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># new model removing LOGLDIST </span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ABUND <span class="sc">~</span> LOGDIST <span class="sc">+</span> YR.ISOL <span class="sc">+</span> ALT <span class="sc">+</span> LOGAREA <span class="sc">+</span> FGRAZE <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>           LOGAREA<span class="sc">:</span>FGRAZE, <span class="at">data =</span> loyn) </span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co"># or use a shortcut with the update() function:</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> <span class="fu">update</span>(M1, <span class="at">formula =</span> . <span class="sc">~</span> . <span class="sc">-</span> LOGLDIST) <span class="co"># &quot;.&quot; means all previous variables</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co"># now redo drop1() on the new model</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="fu">drop1</span>(M2, <span class="at">test =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="do">## Single term deletions</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="do">## Model:</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="do">## ABUND ~ LOGDIST + YR.ISOL + ALT + LOGAREA + FGRAZE + LOGAREA:FGRAZE</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="do">##                Df Sum of Sq    RSS    AIC F value   Pr(&gt;F)   </span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="do">## &lt;none&gt;                      1330.3 226.23                    </span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="do">## LOGDIST         1      3.64 1334.0 224.41  0.1478 0.702134   </span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="do">## YR.ISOL         1      0.78 1331.1 224.27  0.0317 0.859332   </span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="do">## ALT             1     22.24 1352.6 225.34  0.9029 0.346233   </span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="do">## LOGAREA:FGRAZE  4    406.74 1737.1 236.10  4.1275 0.005451 **</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co"># YR.ISOL is now the least significant (p = 0.859), hence makes the least </span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="co"># contribution to the variability explained by the model, </span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="co"># with respect to the number of degrees of freedom it uses (1)</span></span></code></pre></div>
<p> </p>
<p>7. Again, update the model to remove the least significant
explanatory variable (from above) and repeat single term deletions with
<code>drop1()</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>M3 <span class="ot">&lt;-</span> <span class="fu">update</span>(M2, <span class="at">formula =</span> . <span class="sc">~</span> . <span class="sc">-</span> YR.ISOL)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">drop1</span>(M3, <span class="at">test =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="do">## Single term deletions</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="do">## Model:</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="do">## ABUND ~ LOGDIST + ALT + LOGAREA + FGRAZE + LOGAREA:FGRAZE</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="do">##                Df Sum of Sq    RSS    AIC F value   Pr(&gt;F)   </span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="do">## &lt;none&gt;                      1331.1 224.27                    </span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="do">## LOGDIST         1      3.28 1334.4 222.43  0.1355 0.714237   </span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="do">## ALT             1     25.33 1356.5 223.53  1.0468 0.310729   </span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="do">## LOGAREA:FGRAZE  4    405.99 1737.1 234.10  4.1936 0.004916 **</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co"># LOGDIST now the least significant (p = 0.714) and should be removed from </span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co"># the next model.</span></span></code></pre></div>
<p> </p>
<p>8. Once again, update the model to remove the least significant
explanatory variable (from above) and repeat single term deletions with
<code>drop1()</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>M4 <span class="ot">&lt;-</span> <span class="fu">update</span>(M3, <span class="at">formula =</span> . <span class="sc">~</span> . <span class="sc">-</span> LOGDIST)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">drop1</span>(M4, <span class="at">test =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="do">## Single term deletions</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="do">## Model:</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="do">## ABUND ~ ALT + LOGAREA + FGRAZE + LOGAREA:FGRAZE</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="do">##                Df Sum of Sq    RSS    AIC F value   Pr(&gt;F)   </span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="do">## &lt;none&gt;                      1334.4 222.43                    </span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="do">## ALT             1     22.84 1357.2 221.57  0.9584 0.331805   </span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="do">## LOGAREA:FGRAZE  4    408.56 1743.0 232.33  4.2864 0.004273 **</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co"># ALT is not significant (p = 0.331)</span></span></code></pre></div>
<p> </p>
<p>9. And finally, update the model to remove the least significant
explanatory variable (from above) and repeat single term deletions with
<code>drop1()</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># and finally drop ALT from the model</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>M5 <span class="ot">&lt;-</span> <span class="fu">update</span>(M4, <span class="at">formula =</span> . <span class="sc">~</span> . <span class="sc">-</span> ALT)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">drop1</span>(M5, <span class="at">test =</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="do">## Single term deletions</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="do">## Model:</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="do">## ABUND ~ LOGAREA + FGRAZE + LOGAREA:FGRAZE</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="do">##                Df Sum of Sq    RSS    AIC F value  Pr(&gt;F)   </span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="do">## &lt;none&gt;                      1357.2 221.57                   </span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="do">## LOGAREA:FGRAZE  4     389.3 1746.6 230.47  4.0874 0.00556 **</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co"># the LOGAREA:FGRAZE term represents the interaction between LOGAREA and</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co"># FGRAZE. This is significant (p = 0.005) and so our model selection</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co"># process comes to an end.</span></span></code></pre></div>
<p> </p>
<p>10. If all goes well, your final model should be
<code>lm(ABUND ~ LOGAREA + FGRAZE + LOGAREA:FGRAZE)</code> which you
encountered in the previous exercise. Also, you may have noticed that
the output from the <code>drop1()</code> function does not include the
main effects of <code>LOGAREA</code> or <code>FRGRAZE</code>. Can you
think why this might be the case?</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># As the interaction between LOGAREA and FGRAZE was significant at each step of</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co"># model selection process the main effects should be left in our model,</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co"># irrespective of significance. This is because it is quite difficult to </span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co"># interpret an interaction without the main effects. The drop1 </span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co"># function is clever enough that it doesn&#39;t let you see the P values for the </span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co"># main effects, in the presence of their significant interaction.</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co"># Also note, because R always includes interactions *after* their main effects</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co"># the P value of the interaction term (p = 0.005) from the model selection </span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co"># is the same as P value if we use the anova() function on our final model</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co"># Check this:</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="fu">anova</span>(M5)</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="do">## Response: ABUND</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="do">##                Df Sum Sq Mean Sq  F value    Pr(&gt;F)    </span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="do">## LOGAREA         1 3978.1  3978.1 167.0669 &lt; 2.2e-16 ***</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="do">## FGRAZE          4 1038.2   259.5  10.9000 1.241e-06 ***</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="do">## LOGAREA:FGRAZE  4  389.3    97.3   4.0874   0.00556 ** </span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="do">## Residuals      57 1357.3    23.8                       </span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="fu">drop1</span>(M5, <span class="at">test=</span> <span class="st">&quot;F&quot;</span>) </span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="do">## Single term deletions</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a><span class="do">## Model:</span></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a><span class="do">## ABUND ~ LOGAREA + FGRAZE + LOGAREA:FGRAZE</span></span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="do">##                Df Sum of Sq    RSS    AIC F value  Pr(&gt;F)   </span></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="do">## &lt;none&gt;                      1357.2 221.57                   </span></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a><span class="do">## LOGAREA:FGRAZE  4     389.3 1746.6 230.47  4.0874 0.00556 **</span></span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p> </p>
<p>11. Now that you have your final model, you should go through your
model validation and model interpretation as usual. As we have already
completed this in the previous exercise I’ll leave it up to you to
decide whether you include it here (you should be able to just copy and
paste the code).</p>
<p>Please make sure you understand the biological interpretation of each
of the parameter estimates and the interpretation of the hypotheses you
are testing.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Biologically: confirming what we already found out in the previous exercise:</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co"># There is a significant interaction between the area of the patch and the level </span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co"># of grazing </span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># However, some observations are poorly predicted (fitted) using the set of</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co"># available explanatory variables (i.e. the two very large forest patches)</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co"># Interpretation: </span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co"># Bird abundance might increase with patch area due to populations being more</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co"># viable in large patches (e.g. less prone to extinction), </span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co"># or perhaps because there is proportionally less edge effect in larger</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co"># patches, and this in turn provides more high quality habitat for species </span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co"># associated with these habitat patches</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co"># The negative effect of grazing may be due to grazing decreasing resource</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co"># availability for birds, for example plants or seeds directly, or insects</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co"># associated with the grazed plants. There may also be more disturbance of birds</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co"># in highly grazed forest patches resulting in fewer foraging opportunities</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co"># or chances to mate (this is all speculation mind you!).</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co"># Methodologically:</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co"># Doing model selection is difficult without intrinsic / expert knowledge</span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co"># of the system, to guide what variables to include.</span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="co"># Even with this data set, many more models could have been formulated.</span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a><span class="co"># For example, for me, theory would have suggested to test an interaction </span></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="co"># between YR.ISOL and LOGDIST (or LOGLDIST?), </span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a><span class="co"># because LOGDIST will affect the dispersal of birds between patches </span></span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a><span class="co"># (hence the colonisation rate), and the time since isolation of the patch may </span></span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a><span class="co"># affect how important dispersal has been to maintain or rescue populations </span></span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a><span class="co"># (for recently isolated patches, dispersal, and hence distance to nearest</span></span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a><span class="co"># patches may have a less important effect)</span></span></code></pre></div>
<p> </p>
<p><strong>OPTIONAL questions</strong> if you have time / energy /
inclination!</p>
<p> </p>
<p>A1. If we weren’t aiming to directly test the effect of the
<code>LOGAREA:FGRAZE</code> interaction statistically (i.e. test this
specific hypothesis), we could use AIC to perform model selection.
Repeat the model selection you did above, but this time use the
<code>drop1()</code> function and perform model selection using AIC
instead. Don’t forget, if we want to perform model selection based on
AIC with the <code>drop1()</code> function we need to omit the
<code>test = "F"</code> argument)</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># This time, we are not doing any specific hypothesis testing, rather we are </span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co"># attempting to select a model with the &#39;best&#39; goodness of fit with the minimal</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co"># number of estimated parameters. </span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co"># We will start with a reasonably complex but PLAUSABLE model (this is the same </span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co"># model we started with using F test based model selection above.</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>M.start.AIC<span class="ot">&lt;-</span> <span class="fu">lm</span>(ABUND <span class="sc">~</span> LOGLDIST <span class="sc">+</span> LOGDIST <span class="sc">+</span> YR.ISOL <span class="sc">+</span> ALT <span class="sc">+</span> LOGAREA <span class="sc">+</span> FGRAZE <span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>               LOGAREA<span class="sc">:</span>FGRAZE, <span class="at">data =</span> loyn)</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="fu">drop1</span>(M.start.AIC)</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="do">## Single term deletions</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="do">## Model:</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="do">## ABUND ~ LOGLDIST + LOGDIST + YR.ISOL + ALT + LOGAREA + FGRAZE + </span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="do">##     LOGAREA:FGRAZE</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="do">##                Df Sum of Sq    RSS    AIC</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="do">## &lt;none&gt;                      1329.8 228.20</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="do">## LOGLDIST        1      0.55 1330.3 226.23</span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="do">## LOGDIST         1      4.02 1333.8 226.40</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="do">## YR.ISOL         1      0.77 1330.6 226.24</span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="do">## ALT             1     20.84 1350.6 227.24</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="do">## LOGAREA:FGRAZE  4    405.04 1734.8 238.02</span></span></code></pre></div>
<p> </p>
<p>A2. Refit your model with the variable associated with the lowest AIC
value removed. Run <code>drop1()</code> again on your updated model.
Perhaps call this new model <code>M2.AIC</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># So, our starting model with no variables removed has an AIC of 228.20. If we </span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co"># remove the interaction term `LOGAREA:FGRAZE` from the model then this results </span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co"># in a big increase in AIC (238.02 - 228.20 = 9.82) so this suggests that there </span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co"># is substantial evidence that the interaction should remain in the model. The </span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co"># models without `LOGLDIST`, `LOGDIST`, `YR.ISOL` all have pretty much the </span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co"># same AIC value (around 226) so in practice we could remove any of them. Let&#39;s </span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co"># remove the term that results in the model with the lowest AIC which is the </span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co"># `LOGLDIST` variable (AIC 226.23).</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>M2.AIC <span class="ot">&lt;-</span> <span class="fu">update</span>(M.start.AIC, <span class="at">formula =</span> . <span class="sc">~</span> . <span class="sc">-</span> LOGLDIST)</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="fu">drop1</span>(M2.AIC)</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="do">## Single term deletions</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="do">## Model:</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="do">## ABUND ~ LOGDIST + YR.ISOL + ALT + LOGAREA + FGRAZE + LOGAREA:FGRAZE</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="do">##                Df Sum of Sq    RSS    AIC</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="do">## &lt;none&gt;                      1330.3 226.23</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="do">## LOGDIST         1      3.64 1334.0 224.41</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="do">## YR.ISOL         1      0.78 1331.1 224.27</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="do">## ALT             1     22.24 1352.6 225.34</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="do">## LOGAREA:FGRAZE  4    406.74 1737.1 236.10</span></span></code></pre></div>
<p> </p>
<p>A3. Refit your model with the variable associated with the lowest AIC
value removed and run <code>drop1()</code> again on your new model
(<code>M3.AIC</code>).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Ok, as the model without the variable `YR.ISOL` has the lowest AIC (224.27) </span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co"># let&#39;s update our model and remove this variable.</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>M3.AIC <span class="ot">&lt;-</span> <span class="fu">update</span>(M2.AIC, <span class="at">formula =</span> . <span class="sc">~</span> . <span class="sc">-</span> YR.ISOL)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="fu">drop1</span>(M3.AIC)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="do">## Single term deletions</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="do">## Model:</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="do">## ABUND ~ LOGDIST + ALT + LOGAREA + FGRAZE + LOGAREA:FGRAZE</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="do">##                Df Sum of Sq    RSS    AIC</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="do">## &lt;none&gt;                      1331.1 224.27</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="do">## LOGDIST         1      3.28 1334.4 222.43</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="do">## ALT             1     25.33 1356.5 223.53</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="do">## LOGAREA:FGRAZE  4    405.99 1737.1 234.10</span></span></code></pre></div>
<p> </p>
<p>A4. Repeat your model selection by removing the variable indicated by
the model with the lowest AIC.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># So, now the model without `LOGDIST` has the lowest AIC (222.43) so we should </span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co"># refit the model without this variable and run `drop1()` again.</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>M4.AIC <span class="ot">&lt;-</span> <span class="fu">update</span>(M3.AIC, <span class="at">formula =</span> . <span class="sc">~</span> . <span class="sc">-</span> LOGDIST)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="fu">drop1</span>(M4.AIC)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="do">## Single term deletions</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="do">## Model:</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="do">## ABUND ~ ALT + LOGAREA + FGRAZE + LOGAREA:FGRAZE</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="do">##                Df Sum of Sq    RSS    AIC</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="do">## &lt;none&gt;                      1334.4 222.43</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="do">## ALT             1     22.84 1357.2 221.57</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="do">## LOGAREA:FGRAZE  4    408.56 1743.0 232.33</span></span></code></pre></div>
<p> </p>
<p>A5. Rinse and repeat as above.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># And the model without the variable `ALT` has an AIC of 221.57 which is about </span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co"># the same as the model with `ALT` (AIC 222.43), so let&#39;s remove this variable </span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co"># from the model as this suggests that the simpler model fits our data just as </span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co"># well as the more complicated model.</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>M5.AIC <span class="ot">&lt;-</span> <span class="fu">update</span>(M4.AIC, <span class="at">formula =</span> . <span class="sc">~</span> . <span class="sc">-</span> ALT)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="fu">drop1</span>(M5.AIC)</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="do">## Single term deletions</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="do">## Model:</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="do">## ABUND ~ LOGAREA + FGRAZE + LOGAREA:FGRAZE</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="do">##                Df Sum of Sq    RSS    AIC</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="do">## &lt;none&gt;                      1357.2 221.57</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="do">## LOGAREA:FGRAZE  4     389.3 1746.6 230.47</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co"># OK, so now we have a model with the main effects of LOGAREA, FGRAZE and the </span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co"># interaction term LOGAREA:FGRAZE. When we remove the interaction term the </span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co"># AIC value increases by 8.9 (230.47-221.57) and this suggests that if we </span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co"># remove the interaction term the model fit is significantly worse. Therefore we </span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co"># should leave it in and finish our model selection here.</span></span></code></pre></div>
<p> </p>
<p>If all goes well, your final model should be
<code>lm(ABUND ~ LOGAREA + FGRAZE + LOGAREA:FGRAZE)</code>. This is the
same model you ended up with when using the <em>F</em> test based model
selection. This might not always be the case and generally speaking AIC
based model selection approaches tend to favour more complicated minimum
adequate models compared to <em>F</em> test based approaches.</p>
<p>We don’t need to re-validate or re-interpret the model, since we have
already done this previously.</p>
<p>I guess the next question is how to present your results from the
model selection process (using either <em>F</em> tests or AIC) in your
paper and/or thesis chapter. One approach which I quite like is to
construct a table which includes a description of all of our models and
associated summary statistics. Let’s do this for the AIC based model
selection but the same principles apply when using <em>F</em> tests
(although you will be presenting <em>F</em> statistics and P values
rather than AIC values).</p>
<p>Although you can use the output from the <code>drop1()</code> (and do
a bit more wrangling) let’s make it a little simpler by fitting all of
our models and then use the <code>AIC()</code> function to calculate the
AIC values for each model rather than <code>drop1()</code>. Details on
how to do this are given in the solutions to this exercise.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># one way of constructing a summary table for reporting the results:</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co"># create a vector of all the models compared during out model selection</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>model.formulas<span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  <span class="st">&quot;LOGLDIST + LOGDIST + YR.ISOL + ALT + LOGAREA + FGRAZE + LOGAREA:FGRAZE&quot;</span>,</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>    <span class="st">&quot;LOGDIST + YR.ISOL + ALT + LOGAREA + FGRAZE + LOGAREA:FGRAZE&quot;</span>,</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>    <span class="st">&quot;ALT + LOGDIST + LOGAREA + FGRAZE + LOGAREA:FGRAZE&quot;</span>,</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>    <span class="st">&quot;ALT + LOGAREA + FGRAZE + LOGAREA:FGRAZE&quot;</span>, </span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>    <span class="st">&quot;LOGAREA + FGRAZE + LOGAREA:FGRAZE&quot;</span>)</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co"># fit each model. Need to use the noquote() function to remove the </span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co"># quotations around our model formula otherwise you will get an error when </span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co"># using the lm() function.</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co"># You will also need to paste the response variable &#39;ABUND ~ &#39; </span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co"># together with out explanatory variables to create a valid model formula</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>M.start <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">noquote</span>(<span class="fu">paste</span>(<span class="st">&#39;ABUND ~&#39;</span>, model.formulas[<span class="dv">1</span>])), <span class="at">data =</span> loyn)</span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>M.step2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">noquote</span>(<span class="fu">paste</span>(<span class="st">&#39;ABUND ~&#39;</span>, model.formulas[<span class="dv">2</span>])), <span class="at">data =</span> loyn)</span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a>M.step3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">noquote</span>(<span class="fu">paste</span>(<span class="st">&#39;ABUND ~&#39;</span>, model.formulas[<span class="dv">3</span>])), <span class="at">data =</span> loyn)</span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a>M.step4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">noquote</span>(<span class="fu">paste</span>(<span class="st">&#39;ABUND ~&#39;</span>, model.formulas[<span class="dv">4</span>])), <span class="at">data =</span> loyn)</span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a>M.step5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">noquote</span>(<span class="fu">paste</span>(<span class="st">&#39;ABUND ~&#39;</span>, model.formulas[<span class="dv">5</span>])), <span class="at">data =</span> loyn)</span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a><span class="co"># obtain the AIC values for each model. Note: these will be different </span></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a><span class="co"># than those obtained with the drop1() function due to a small difference in</span></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a><span class="co"># how AIC is calculated. This isn;t a problem, just don&#39;t mix and match</span></span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a><span class="co"># the AIC values form drop1 and AIC functions.</span></span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a></span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a>model.AIC<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">AIC</span>(M.start),</span>
<span id="cb18-31"><a href="#cb18-31" tabindex="-1"></a>    <span class="fu">AIC</span>(M.step2),</span>
<span id="cb18-32"><a href="#cb18-32" tabindex="-1"></a>    <span class="fu">AIC</span>(M.step3),</span>
<span id="cb18-33"><a href="#cb18-33" tabindex="-1"></a>    <span class="fu">AIC</span>(M.step4),</span>
<span id="cb18-34"><a href="#cb18-34" tabindex="-1"></a>    <span class="fu">AIC</span>(M.step5))</span>
<span id="cb18-35"><a href="#cb18-35" tabindex="-1"></a></span>
<span id="cb18-36"><a href="#cb18-36" tabindex="-1"></a><span class="co"># create a dataframe of models and AIC values</span></span>
<span id="cb18-37"><a href="#cb18-37" tabindex="-1"></a></span>
<span id="cb18-38"><a href="#cb18-38" tabindex="-1"></a>summary.table<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> model.formulas,</span>
<span id="cb18-39"><a href="#cb18-39" tabindex="-1"></a>    <span class="at">AIC=</span> <span class="fu">round</span>(model.AIC, <span class="dv">2</span>))</span>
<span id="cb18-40"><a href="#cb18-40" tabindex="-1"></a></span>
<span id="cb18-41"><a href="#cb18-41" tabindex="-1"></a><span class="co"># Sort the models from lowest AIC (preferred) to highest (least preferred)</span></span>
<span id="cb18-42"><a href="#cb18-42" tabindex="-1"></a></span>
<span id="cb18-43"><a href="#cb18-43" tabindex="-1"></a>summary.table<span class="ot">&lt;-</span> summary.table[<span class="fu">order</span>(summary.table<span class="sc">$</span>AIC), ]</span>
<span id="cb18-44"><a href="#cb18-44" tabindex="-1"></a></span>
<span id="cb18-45"><a href="#cb18-45" tabindex="-1"></a><span class="co"># Add the difference in AIC with respect to best model</span></span>
<span id="cb18-46"><a href="#cb18-46" tabindex="-1"></a></span>
<span id="cb18-47"><a href="#cb18-47" tabindex="-1"></a>summary.table<span class="sc">$</span>deltaAIC<span class="ot">&lt;-</span> summary.table<span class="sc">$</span>AIC <span class="sc">-</span> summary.table<span class="sc">$</span>AIC[<span class="dv">1</span>]</span>
<span id="cb18-48"><a href="#cb18-48" tabindex="-1"></a></span>
<span id="cb18-49"><a href="#cb18-49" tabindex="-1"></a><span class="co"># print the dataframe to the console</span></span>
<span id="cb18-50"><a href="#cb18-50" tabindex="-1"></a></span>
<span id="cb18-51"><a href="#cb18-51" tabindex="-1"></a>summary.table</span>
<span id="cb18-52"><a href="#cb18-52" tabindex="-1"></a><span class="do">##                                                                    Model    AIC deltaAIC</span></span>
<span id="cb18-53"><a href="#cb18-53" tabindex="-1"></a><span class="do">## 5                                      LOGAREA + FGRAZE + LOGAREA:FGRAZE 413.71     0.00</span></span>
<span id="cb18-54"><a href="#cb18-54" tabindex="-1"></a><span class="do">## 4                                ALT + LOGAREA + FGRAZE + LOGAREA:FGRAZE 414.57     0.86</span></span>
<span id="cb18-55"><a href="#cb18-55" tabindex="-1"></a><span class="do">## 3                      ALT + LOGDIST + LOGAREA + FGRAZE + LOGAREA:FGRAZE 416.41     2.70</span></span>
<span id="cb18-56"><a href="#cb18-56" tabindex="-1"></a><span class="do">## 2            LOGDIST + YR.ISOL + ALT + LOGAREA + FGRAZE + LOGAREA:FGRAZE 418.37     4.66</span></span>
<span id="cb18-57"><a href="#cb18-57" tabindex="-1"></a><span class="do">## 1 LOGLDIST + LOGDIST + YR.ISOL + ALT + LOGAREA + FGRAZE + LOGAREA:FGRAZE 420.34     6.63</span></span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:center;">
AIC
</th>
<th style="text-align:right;">
deltaAIC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
LOGAREA + FGRAZE + LOGAREA:FGRAZE
</td>
<td style="text-align:center;">
413.71
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
ALT + LOGAREA + FGRAZE + LOGAREA:FGRAZE
</td>
<td style="text-align:center;">
414.57
</td>
<td style="text-align:right;">
0.86
</td>
</tr>
<tr>
<td style="text-align:left;">
ALT + LOGDIST + LOGAREA + FGRAZE + LOGAREA:FGRAZE
</td>
<td style="text-align:center;">
416.41
</td>
<td style="text-align:right;">
2.70
</td>
</tr>
<tr>
<td style="text-align:left;">
LOGDIST + YR.ISOL + ALT + LOGAREA + FGRAZE + LOGAREA:FGRAZE
</td>
<td style="text-align:center;">
418.37
</td>
<td style="text-align:right;">
4.66
</td>
</tr>
<tr>
<td style="text-align:left;">
LOGLDIST + LOGDIST + YR.ISOL + ALT + LOGAREA + FGRAZE + LOGAREA:FGRAZE
</td>
<td style="text-align:center;">
420.34
</td>
<td style="text-align:right;">
6.63
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>End of the model selection exercise</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
