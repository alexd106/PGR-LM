<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Exercise Solutions</title>

<script src="site_libs/header-attrs-2.5/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">PGR-LM</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="setup.html">
    <span class="fa fa-cog"></span>
     
    Setup
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    R Book
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://intro2r.com">
        <span class="fa fa-firefox"></span>
         
        Web book
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://github.com/alexd106/Rbook/raw/master/docs/Rbook.pdf">
        <span class="fa fa-file-pdf"></span>
         
        PDF book
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="exercises.html">
        <span class="fa fa-book"></span>
         
        Exercises
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="exercise_solutions.html">
        <span class="fa fa-book"></span>
         
        Exercise Solutions
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="data.html">
    <span class="fa fa-download"></span>
     
    Data
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-question-circle"></span>
     
    Info
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="syllabus.html">
        <span class="fa fa-graduation-cap"></span>
         
        Syllabus
      </a>
    </li>
    <li>
      <a href="People.html">
        <span class="fa fa-user-friends"></span>
         
        People
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="resources.html">
        <span class="fa fa-book"></span>
         
        Resources
      </a>
    </li>
    <li>
      <a href="https://forms.gle/uKLPEof845wfPekh9">
        <span class="fa fa-commenting"></span>
         
        Feedback
      </a>
    </li>
    <li>
      <a href="People.html">
        <span class="fa fa-envelope fa-lg"></span>
         
        Contact
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://github.com/alexd106/PGR-LM">
        <span class="fa fa-github fa-lg"></span>
         
        Source code
      </a>
    </li>
    <li>
      <a href="https://twitter.com/Scedacity">
        <span class="fa fa-twitter fa-lg"></span>
         
        Twitter
      </a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Exercise Solutions</h1>

</div>


<p> </p>
<div id="exercise-binomial-proportions-glm---mites-survival" class="section level1">
<h1>Exercise: Binomial (Proportions) GLM - mites survival</h1>
<p> </p>
<p>The data for this exercise were collected for an experiment to test the toxicity of different chemicals at various concentrations to a species of mite. The aim was to determine whether the proportion of mites surviving was related to the concentration of the chemical and whether this relationship depended on the type of chemical the mites were exposed to. We will be using a binomial GLM again for this example, but this time we will be using it to model proportion data, from counts of “successes” (= mite survival, unless you don’t like mites), and “failures” (= mite death).</p>
<ul>
<li>Variables:
<ul>
<li><code>ID</code> index of the observations</li>
<li><code>Concentration</code>: Concentration of the chemical</li>
<li><code>Toxic</code>: Chemical type</li>
<li><code>Dead_mites</code>: Number of dead mites in assay</li>
<li><code>Total</code>: Initial number of mites in assay</li>
<li><code>Proportion</code>= <code>Dead_mites / Total</code></li>
</ul></li>
</ul>
<p> </p>
<p>As in previous exercises, either create a new R script (perhaps call it GLM_BinomProps) or continue with your previous R script in your RStudio Project. Again, make sure you include any metadata you feel is appropriate (title, description of task, date of creation etc) and don’t forget to comment out your metadata with a <code>#</code> at the beginning of the line.</p>
<p> </p>
<p>1. Import the data file ‘DrugsMites.txt’ into R. We want to model the variable Toxic as a categorical predictor with 4 levels, so create a new variable with Toxic as a factor.</p>
<p> </p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>Mites&lt;-<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/DrugsMites.txt&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">str</span>(Mites)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">## &#39;data.frame&#39;:    115 obs. of  6 variables:</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">##  $ ID           : int  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">##  $ Concentration: num  0 0 0 0 0 0.25 0.25 0.25 0.25 0.25 ...</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">##  $ Toxic        : int  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">##  $ Dead_mites   : int  0 0 1 0 0 2 1 3 2 1 ...</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">##  $ Total        : int  4 4 4 4 4 4 4 4 4 4 ...</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">##  $ Proportion   : num  0 0 0.25 0 0 0.5 0.25 0.75 0.5 0.25 ...</span></span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a>Mites<span class="op">$</span>fToxic&lt;-<span class="st"> </span><span class="kw">factor</span>(Mites<span class="op">$</span>Toxic)</span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="kw">str</span>(Mites)</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co">## &#39;data.frame&#39;:    115 obs. of  7 variables:</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co">##  $ ID           : int  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co">##  $ Concentration: num  0 0 0 0 0 0.25 0.25 0.25 0.25 0.25 ...</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co">##  $ Toxic        : int  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co">##  $ Dead_mites   : int  0 0 1 0 0 2 1 3 2 1 ...</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="co">##  $ Total        : int  4 4 4 4 4 4 4 4 4 4 ...</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="co">##  $ Proportion   : num  0 0 0.25 0 0 0.5 0.25 0.75 0.5 0.25 ...</span></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="co">##  $ fToxic       : Factor w/ 4 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;: 1 1 1 1 1 1 1 1 1 1 ...</span></span></code></pre></div>
<p> </p>
<p>2. Perform the usual graphical data exploration, looking for outliers, relationships between predictors, and between response and predictors etc. You can use the variable <code>Proportion</code> in the data frame for these plots.</p>
<p> </p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Outliers Y</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">boxplot</span>(Mites<span class="op">$</span>Proportion) <span class="co"># not very useful for this data set</span></span></code></pre></div>
<p><img src="GLM_3_BinomialProportions_exercise_solutions_files/figure-html/Q2-1.png" width="672" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">dotchart</span>(Mites<span class="op">$</span>Proportion)</span></code></pre></div>
<p><img src="GLM_3_BinomialProportions_exercise_solutions_files/figure-html/Q2-2.png" width="672" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"># Outliers X</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="kw">dotchart</span>(Mites<span class="op">$</span>Concentration)</span></code></pre></div>
<p><img src="GLM_3_BinomialProportions_exercise_solutions_files/figure-html/Q2-3.png" width="672" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co"># Correlations between predictors</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="kw">plot</span>(<span class="kw">jitter</span>(Mites<span class="op">$</span>Concentration), <span class="kw">jitter</span>(Mites<span class="op">$</span>Toxic))</span></code></pre></div>
<p><img src="GLM_3_BinomialProportions_exercise_solutions_files/figure-html/Q2-4.png" width="672" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co"># Toxics 2 and 3 have not been assayed at the highest concentrations</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co"># but have had more trials at the lower concentrations</span></span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co"># Relationships</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="kw">boxplot</span>(Proportion <span class="op">~</span><span class="st"> </span>Toxic, <span class="dt">data=</span> Mites)</span></code></pre></div>
<p><img src="GLM_3_BinomialProportions_exercise_solutions_files/figure-html/Q2-5.png" width="672" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">with</span>(Mites, <span class="kw">plot</span>(<span class="dt">x=</span> Concentration, <span class="dt">y=</span> Proportion))</span></code></pre></div>
<p><img src="GLM_3_BinomialProportions_exercise_solutions_files/figure-html/Q2-6.png" width="672" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co"># Since lots of proportions have the same values, we can also add</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co"># a bit of noise to the coordinates in the previous plot, to limit overlap:</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="kw">with</span>(Mites, <span class="kw">plot</span>(<span class="dt">x=</span> <span class="kw">jitter</span>(Concentration), <span class="dt">y=</span> <span class="kw">jitter</span>(Proportion)))</span></code></pre></div>
<p><img src="GLM_3_BinomialProportions_exercise_solutions_files/figure-html/Q2-7.png" width="672" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">coplot</span>(<span class="kw">jitter</span>(Proportion) <span class="op">~</span><span class="st"> </span><span class="kw">jitter</span>(Concentration) <span class="op">|</span><span class="st"> </span>fToxic, <span class="dt">data=</span> Mites)</span></code></pre></div>
<p><img src="GLM_3_BinomialProportions_exercise_solutions_files/figure-html/Q2-8.png" width="672" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co"># looks like researchers stopped increasing concentration of a chemical when they had</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co"># reached ~ 100 % mortality in assays</span></span></code></pre></div>
<p> </p>
<p>3. In order to model the proportion of mites surviving, create a new variable (called something creative like Living_mites for example) representing the number of surviving mites by differencing the two variables Dead_mites and Total.</p>
<p> </p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>Mites<span class="op">$</span>Living_mites&lt;-<span class="st"> </span>Mites<span class="op">$</span>Total <span class="op">-</span><span class="st"> </span>Mites<span class="op">$</span>Dead_mites</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="kw">table</span>(Mites<span class="op">$</span>Total)</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">## </span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">##  3  4  5 </span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">## 40 25 50</span></span></code></pre></div>
<p> </p>
<p>4. We can now use this new variable when specifying a binomial GLM. Recall from the lecture that the response variable should be a data frame consisting of two columns, cbind(Living_mites, Dead_mites). Ask if in doubt. If you hate mites you could also swap the order of the two columns: you would then be modelling the proportion that die.</p>
<p> </p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>M1&lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="kw">cbind</span>(Living_mites, Dead_mites) <span class="op">~</span><span class="st"> </span>Concentration <span class="op">+</span><span class="st"> </span>fToxic <span class="op">+</span><span class="st"> </span>Concentration <span class="op">:</span><span class="st"> </span>fToxic, <span class="dt">family=</span> binomial, <span class="dt">data=</span> Mites)</span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a>M1&lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="kw">cbind</span>(Living_mites, Dead_mites) <span class="op">~</span><span class="st"> </span>Concentration <span class="op">*</span><span class="st"> </span>fToxic, <span class="dt">family=</span> binomial, <span class="dt">data=</span> Mites)</span></code></pre></div>
<p> </p>
<p>5. Obtain summaries of the model output using the <code>summary()</code> function. Make sure you understand the mathematical and biological interpretation of the model, by writing down the complete model on paper (with distribution and link function). What biological hypothesis does each term imply, qualitatively?</p>
<p> </p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">summary</span>(M1)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co">## </span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">## Call:</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">## glm(formula = cbind(Living_mites, Dead_mites) ~ Concentration * </span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">##     fToxic, family = binomial, data = Mites)</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">## </span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">## Deviance Residuals: </span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">##     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">## -2.0569  -0.5875  -0.1295   0.7435   2.6011  </span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co">## </span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co">## Coefficients:</span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="co">##                       Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="co">## (Intercept)            1.43483    0.41664   3.444 0.000574 ***</span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co">## Concentration         -3.80101    0.87479  -4.345 1.39e-05 ***</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co">## fToxic2                0.00860    0.57713   0.015 0.988111    </span></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="co">## fToxic3                0.01419    0.58714   0.024 0.980717    </span></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="co">## fToxic4                0.27387    0.58485   0.468 0.639594    </span></span>
<span id="cb13-18"><a href="#cb13-18"></a><span class="co">## Concentration:fToxic2 -6.17647    2.28823  -2.699 0.006950 ** </span></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co">## Concentration:fToxic3 -1.89983    1.36204  -1.395 0.163062    </span></span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="co">## Concentration:fToxic4  1.48275    0.96299   1.540 0.123626    </span></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="co">## ---</span></span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="co">## </span></span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb13-25"><a href="#cb13-25"></a><span class="co">## </span></span>
<span id="cb13-26"><a href="#cb13-26"></a><span class="co">##     Null deviance: 342.07  on 114  degrees of freedom</span></span>
<span id="cb13-27"><a href="#cb13-27"></a><span class="co">## Residual deviance: 117.67  on 107  degrees of freedom</span></span>
<span id="cb13-28"><a href="#cb13-28"></a><span class="co">## AIC: 231.43</span></span>
<span id="cb13-29"><a href="#cb13-29"></a><span class="co">## </span></span>
<span id="cb13-30"><a href="#cb13-30"></a><span class="co">## Number of Fisher Scoring iterations: 6</span></span>
<span id="cb13-31"><a href="#cb13-31"></a></span>
<span id="cb13-32"><a href="#cb13-32"></a><span class="kw">coef</span>(M1)</span>
<span id="cb13-33"><a href="#cb13-33"></a><span class="co">##           (Intercept)         Concentration               fToxic2               fToxic3               fToxic4 Concentration:fToxic2 </span></span>
<span id="cb13-34"><a href="#cb13-34"></a><span class="co">##           1.434827258          -3.801011714           0.008599625           0.014191002           0.273864642          -6.176473370 </span></span>
<span id="cb13-35"><a href="#cb13-35"></a><span class="co">## Concentration:fToxic3 Concentration:fToxic4 </span></span>
<span id="cb13-36"><a href="#cb13-36"></a><span class="co">##          -1.899832702           1.482751939</span></span>
<span id="cb13-37"><a href="#cb13-37"></a></span>
<span id="cb13-38"><a href="#cb13-38"></a><span class="kw">model.matrix</span>(M1)</span>
<span id="cb13-39"><a href="#cb13-39"></a><span class="co">##     (Intercept) Concentration fToxic2 fToxic3 fToxic4 Concentration:fToxic2 Concentration:fToxic3 Concentration:fToxic4</span></span>
<span id="cb13-40"><a href="#cb13-40"></a><span class="co">## 1             1          0.00       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-41"><a href="#cb13-41"></a><span class="co">## 2             1          0.00       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-42"><a href="#cb13-42"></a><span class="co">## 3             1          0.00       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-43"><a href="#cb13-43"></a><span class="co">## 4             1          0.00       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-44"><a href="#cb13-44"></a><span class="co">## 5             1          0.00       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-45"><a href="#cb13-45"></a><span class="co">## 6             1          0.25       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-46"><a href="#cb13-46"></a><span class="co">## 7             1          0.25       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-47"><a href="#cb13-47"></a><span class="co">## 8             1          0.25       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-48"><a href="#cb13-48"></a><span class="co">## 9             1          0.25       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-49"><a href="#cb13-49"></a><span class="co">## 10            1          0.25       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-50"><a href="#cb13-50"></a><span class="co">## 11            1          0.50       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-51"><a href="#cb13-51"></a><span class="co">## 12            1          0.50       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-52"><a href="#cb13-52"></a><span class="co">## 13            1          0.50       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-53"><a href="#cb13-53"></a><span class="co">## 14            1          0.50       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-54"><a href="#cb13-54"></a><span class="co">## 15            1          0.50       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-55"><a href="#cb13-55"></a><span class="co">## 16            1          1.00       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-56"><a href="#cb13-56"></a><span class="co">## 17            1          1.00       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-57"><a href="#cb13-57"></a><span class="co">## 18            1          1.00       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-58"><a href="#cb13-58"></a><span class="co">## 19            1          1.00       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-59"><a href="#cb13-59"></a><span class="co">## 20            1          1.00       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-60"><a href="#cb13-60"></a><span class="co">## 21            1          2.00       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-61"><a href="#cb13-61"></a><span class="co">## 22            1          2.00       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-62"><a href="#cb13-62"></a><span class="co">## 23            1          2.00       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-63"><a href="#cb13-63"></a><span class="co">## 24            1          2.00       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-64"><a href="#cb13-64"></a><span class="co">## 25            1          2.00       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-65"><a href="#cb13-65"></a><span class="co">## 26            1          0.00       1       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-66"><a href="#cb13-66"></a><span class="co">## 27            1          0.00       1       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-67"><a href="#cb13-67"></a><span class="co">## 28            1          0.00       1       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-68"><a href="#cb13-68"></a><span class="co">## 29            1          0.00       1       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-69"><a href="#cb13-69"></a><span class="co">## 30            1          0.00       1       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-70"><a href="#cb13-70"></a><span class="co">## 31            1          0.12       1       0       0                  0.12                  0.00                  0.00</span></span>
<span id="cb13-71"><a href="#cb13-71"></a><span class="co">## 32            1          0.12       1       0       0                  0.12                  0.00                  0.00</span></span>
<span id="cb13-72"><a href="#cb13-72"></a><span class="co">## 33            1          0.12       1       0       0                  0.12                  0.00                  0.00</span></span>
<span id="cb13-73"><a href="#cb13-73"></a><span class="co">## 34            1          0.12       1       0       0                  0.12                  0.00                  0.00</span></span>
<span id="cb13-74"><a href="#cb13-74"></a><span class="co">## 35            1          0.12       1       0       0                  0.12                  0.00                  0.00</span></span>
<span id="cb13-75"><a href="#cb13-75"></a><span class="co">## 36            1          0.24       1       0       0                  0.24                  0.00                  0.00</span></span>
<span id="cb13-76"><a href="#cb13-76"></a><span class="co">## 37            1          0.24       1       0       0                  0.24                  0.00                  0.00</span></span>
<span id="cb13-77"><a href="#cb13-77"></a><span class="co">## 38            1          0.24       1       0       0                  0.24                  0.00                  0.00</span></span>
<span id="cb13-78"><a href="#cb13-78"></a><span class="co">## 39            1          0.24       1       0       0                  0.24                  0.00                  0.00</span></span>
<span id="cb13-79"><a href="#cb13-79"></a><span class="co">## 40            1          0.24       1       0       0                  0.24                  0.00                  0.00</span></span>
<span id="cb13-80"><a href="#cb13-80"></a><span class="co">## 41            1          0.49       1       0       0                  0.49                  0.00                  0.00</span></span>
<span id="cb13-81"><a href="#cb13-81"></a><span class="co">## 42            1          0.49       1       0       0                  0.49                  0.00                  0.00</span></span>
<span id="cb13-82"><a href="#cb13-82"></a><span class="co">## 43            1          0.49       1       0       0                  0.49                  0.00                  0.00</span></span>
<span id="cb13-83"><a href="#cb13-83"></a><span class="co">## 44            1          0.49       1       0       0                  0.49                  0.00                  0.00</span></span>
<span id="cb13-84"><a href="#cb13-84"></a><span class="co">## 45            1          0.49       1       0       0                  0.49                  0.00                  0.00</span></span>
<span id="cb13-85"><a href="#cb13-85"></a><span class="co">## 46            1          0.98       1       0       0                  0.98                  0.00                  0.00</span></span>
<span id="cb13-86"><a href="#cb13-86"></a><span class="co">## 47            1          0.98       1       0       0                  0.98                  0.00                  0.00</span></span>
<span id="cb13-87"><a href="#cb13-87"></a><span class="co">## 48            1          0.98       1       0       0                  0.98                  0.00                  0.00</span></span>
<span id="cb13-88"><a href="#cb13-88"></a><span class="co">## 49            1          0.98       1       0       0                  0.98                  0.00                  0.00</span></span>
<span id="cb13-89"><a href="#cb13-89"></a><span class="co">## 50            1          0.98       1       0       0                  0.98                  0.00                  0.00</span></span>
<span id="cb13-90"><a href="#cb13-90"></a><span class="co">## 51            1          0.00       0       1       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-91"><a href="#cb13-91"></a><span class="co">## 52            1          0.00       0       1       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-92"><a href="#cb13-92"></a><span class="co">## 53            1          0.00       0       1       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-93"><a href="#cb13-93"></a><span class="co">## 54            1          0.00       0       1       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-94"><a href="#cb13-94"></a><span class="co">## 55            1          0.00       0       1       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-95"><a href="#cb13-95"></a><span class="co">## 56            1          0.00       0       1       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-96"><a href="#cb13-96"></a><span class="co">## 57            1          0.00       0       1       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-97"><a href="#cb13-97"></a><span class="co">## 58            1          0.00       0       1       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-98"><a href="#cb13-98"></a><span class="co">## 59            1          0.25       0       1       0                  0.00                  0.25                  0.00</span></span>
<span id="cb13-99"><a href="#cb13-99"></a><span class="co">## 60            1          0.25       0       1       0                  0.00                  0.25                  0.00</span></span>
<span id="cb13-100"><a href="#cb13-100"></a><span class="co">## 61            1          0.25       0       1       0                  0.00                  0.25                  0.00</span></span>
<span id="cb13-101"><a href="#cb13-101"></a><span class="co">## 62            1          0.25       0       1       0                  0.00                  0.25                  0.00</span></span>
<span id="cb13-102"><a href="#cb13-102"></a><span class="co">## 63            1          0.25       0       1       0                  0.00                  0.25                  0.00</span></span>
<span id="cb13-103"><a href="#cb13-103"></a><span class="co">## 64            1          0.25       0       1       0                  0.00                  0.25                  0.00</span></span>
<span id="cb13-104"><a href="#cb13-104"></a><span class="co">## 65            1          0.25       0       1       0                  0.00                  0.25                  0.00</span></span>
<span id="cb13-105"><a href="#cb13-105"></a><span class="co">## 66            1          0.25       0       1       0                  0.00                  0.25                  0.00</span></span>
<span id="cb13-106"><a href="#cb13-106"></a><span class="co">## 67            1          0.50       0       1       0                  0.00                  0.50                  0.00</span></span>
<span id="cb13-107"><a href="#cb13-107"></a><span class="co">## 68            1          0.50       0       1       0                  0.00                  0.50                  0.00</span></span>
<span id="cb13-108"><a href="#cb13-108"></a><span class="co">## 69            1          0.50       0       1       0                  0.00                  0.50                  0.00</span></span>
<span id="cb13-109"><a href="#cb13-109"></a><span class="co">## 70            1          0.50       0       1       0                  0.00                  0.50                  0.00</span></span>
<span id="cb13-110"><a href="#cb13-110"></a><span class="co">## 71            1          0.50       0       1       0                  0.00                  0.50                  0.00</span></span>
<span id="cb13-111"><a href="#cb13-111"></a><span class="co">## 72            1          0.50       0       1       0                  0.00                  0.50                  0.00</span></span>
<span id="cb13-112"><a href="#cb13-112"></a><span class="co">## 73            1          0.50       0       1       0                  0.00                  0.50                  0.00</span></span>
<span id="cb13-113"><a href="#cb13-113"></a><span class="co">## 74            1          0.50       0       1       0                  0.00                  0.50                  0.00</span></span>
<span id="cb13-114"><a href="#cb13-114"></a><span class="co">## 75            1          0.75       0       1       0                  0.00                  0.75                  0.00</span></span>
<span id="cb13-115"><a href="#cb13-115"></a><span class="co">## 76            1          0.75       0       1       0                  0.00                  0.75                  0.00</span></span>
<span id="cb13-116"><a href="#cb13-116"></a><span class="co">## 77            1          0.75       0       1       0                  0.00                  0.75                  0.00</span></span>
<span id="cb13-117"><a href="#cb13-117"></a><span class="co">## 78            1          0.75       0       1       0                  0.00                  0.75                  0.00</span></span>
<span id="cb13-118"><a href="#cb13-118"></a><span class="co">## 79            1          0.75       0       1       0                  0.00                  0.75                  0.00</span></span>
<span id="cb13-119"><a href="#cb13-119"></a><span class="co">## 80            1          0.75       0       1       0                  0.00                  0.75                  0.00</span></span>
<span id="cb13-120"><a href="#cb13-120"></a><span class="co">## 81            1          0.75       0       1       0                  0.00                  0.75                  0.00</span></span>
<span id="cb13-121"><a href="#cb13-121"></a><span class="co">## 82            1          0.75       0       1       0                  0.00                  0.75                  0.00</span></span>
<span id="cb13-122"><a href="#cb13-122"></a><span class="co">## 83            1          1.00       0       1       0                  0.00                  1.00                  0.00</span></span>
<span id="cb13-123"><a href="#cb13-123"></a><span class="co">## 84            1          1.00       0       1       0                  0.00                  1.00                  0.00</span></span>
<span id="cb13-124"><a href="#cb13-124"></a><span class="co">## 85            1          1.00       0       1       0                  0.00                  1.00                  0.00</span></span>
<span id="cb13-125"><a href="#cb13-125"></a><span class="co">## 86            1          1.00       0       1       0                  0.00                  1.00                  0.00</span></span>
<span id="cb13-126"><a href="#cb13-126"></a><span class="co">## 87            1          1.00       0       1       0                  0.00                  1.00                  0.00</span></span>
<span id="cb13-127"><a href="#cb13-127"></a><span class="co">## 88            1          1.00       0       1       0                  0.00                  1.00                  0.00</span></span>
<span id="cb13-128"><a href="#cb13-128"></a><span class="co">## 89            1          1.00       0       1       0                  0.00                  1.00                  0.00</span></span>
<span id="cb13-129"><a href="#cb13-129"></a><span class="co">## 90            1          1.00       0       1       0                  0.00                  1.00                  0.00</span></span>
<span id="cb13-130"><a href="#cb13-130"></a><span class="co">## 91            1          0.00       0       0       1                  0.00                  0.00                  0.00</span></span>
<span id="cb13-131"><a href="#cb13-131"></a><span class="co">## 92            1          0.00       0       0       1                  0.00                  0.00                  0.00</span></span>
<span id="cb13-132"><a href="#cb13-132"></a><span class="co">## 93            1          0.00       0       0       1                  0.00                  0.00                  0.00</span></span>
<span id="cb13-133"><a href="#cb13-133"></a><span class="co">## 94            1          0.00       0       0       1                  0.00                  0.00                  0.00</span></span>
<span id="cb13-134"><a href="#cb13-134"></a><span class="co">## 95            1          0.00       0       0       1                  0.00                  0.00                  0.00</span></span>
<span id="cb13-135"><a href="#cb13-135"></a><span class="co">## 96            1          0.54       0       0       1                  0.00                  0.00                  0.54</span></span>
<span id="cb13-136"><a href="#cb13-136"></a><span class="co">## 97            1          0.54       0       0       1                  0.00                  0.00                  0.54</span></span>
<span id="cb13-137"><a href="#cb13-137"></a><span class="co">## 98            1          0.54       0       0       1                  0.00                  0.00                  0.54</span></span>
<span id="cb13-138"><a href="#cb13-138"></a><span class="co">## 99            1          0.54       0       0       1                  0.00                  0.00                  0.54</span></span>
<span id="cb13-139"><a href="#cb13-139"></a><span class="co">## 100           1          0.54       0       0       1                  0.00                  0.00                  0.54</span></span>
<span id="cb13-140"><a href="#cb13-140"></a><span class="co">## 101           1          1.08       0       0       1                  0.00                  0.00                  1.08</span></span>
<span id="cb13-141"><a href="#cb13-141"></a><span class="co">## 102           1          1.08       0       0       1                  0.00                  0.00                  1.08</span></span>
<span id="cb13-142"><a href="#cb13-142"></a><span class="co">## 103           1          1.08       0       0       1                  0.00                  0.00                  1.08</span></span>
<span id="cb13-143"><a href="#cb13-143"></a><span class="co">## 104           1          1.08       0       0       1                  0.00                  0.00                  1.08</span></span>
<span id="cb13-144"><a href="#cb13-144"></a><span class="co">## 105           1          1.08       0       0       1                  0.00                  0.00                  1.08</span></span>
<span id="cb13-145"><a href="#cb13-145"></a><span class="co">## 106           1          1.62       0       0       1                  0.00                  0.00                  1.62</span></span>
<span id="cb13-146"><a href="#cb13-146"></a><span class="co">## 107           1          1.62       0       0       1                  0.00                  0.00                  1.62</span></span>
<span id="cb13-147"><a href="#cb13-147"></a><span class="co">## 108           1          1.62       0       0       1                  0.00                  0.00                  1.62</span></span>
<span id="cb13-148"><a href="#cb13-148"></a><span class="co">## 109           1          1.62       0       0       1                  0.00                  0.00                  1.62</span></span>
<span id="cb13-149"><a href="#cb13-149"></a><span class="co">## 110           1          1.62       0       0       1                  0.00                  0.00                  1.62</span></span>
<span id="cb13-150"><a href="#cb13-150"></a><span class="co">## 111           1          2.16       0       0       1                  0.00                  0.00                  2.16</span></span>
<span id="cb13-151"><a href="#cb13-151"></a><span class="co">## 112           1          2.16       0       0       1                  0.00                  0.00                  2.16</span></span>
<span id="cb13-152"><a href="#cb13-152"></a><span class="co">## 113           1          2.16       0       0       1                  0.00                  0.00                  2.16</span></span>
<span id="cb13-153"><a href="#cb13-153"></a><span class="co">## 114           1          2.16       0       0       1                  0.00                  0.00                  2.16</span></span>
<span id="cb13-154"><a href="#cb13-154"></a><span class="co">## 115           1          2.16       0       0       1                  0.00                  0.00                  2.16</span></span>
<span id="cb13-155"><a href="#cb13-155"></a><span class="co">## attr(,&quot;assign&quot;)</span></span>
<span id="cb13-156"><a href="#cb13-156"></a><span class="co">## [1] 0 1 2 2 2 3 3 3</span></span>
<span id="cb13-157"><a href="#cb13-157"></a><span class="co">## attr(,&quot;contrasts&quot;)</span></span>
<span id="cb13-158"><a href="#cb13-158"></a><span class="co">## attr(,&quot;contrasts&quot;)$fToxic</span></span>
<span id="cb13-159"><a href="#cb13-159"></a><span class="co">## [1] &quot;contr.treatment&quot;</span></span>
<span id="cb13-160"><a href="#cb13-160"></a></span>
<span id="cb13-161"><a href="#cb13-161"></a><span class="kw">unique</span>(<span class="kw">model.matrix</span>(M1))</span>
<span id="cb13-162"><a href="#cb13-162"></a><span class="co">##     (Intercept) Concentration fToxic2 fToxic3 fToxic4 Concentration:fToxic2 Concentration:fToxic3 Concentration:fToxic4</span></span>
<span id="cb13-163"><a href="#cb13-163"></a><span class="co">## 1             1          0.00       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-164"><a href="#cb13-164"></a><span class="co">## 6             1          0.25       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-165"><a href="#cb13-165"></a><span class="co">## 11            1          0.50       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-166"><a href="#cb13-166"></a><span class="co">## 16            1          1.00       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-167"><a href="#cb13-167"></a><span class="co">## 21            1          2.00       0       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-168"><a href="#cb13-168"></a><span class="co">## 26            1          0.00       1       0       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-169"><a href="#cb13-169"></a><span class="co">## 31            1          0.12       1       0       0                  0.12                  0.00                  0.00</span></span>
<span id="cb13-170"><a href="#cb13-170"></a><span class="co">## 36            1          0.24       1       0       0                  0.24                  0.00                  0.00</span></span>
<span id="cb13-171"><a href="#cb13-171"></a><span class="co">## 41            1          0.49       1       0       0                  0.49                  0.00                  0.00</span></span>
<span id="cb13-172"><a href="#cb13-172"></a><span class="co">## 46            1          0.98       1       0       0                  0.98                  0.00                  0.00</span></span>
<span id="cb13-173"><a href="#cb13-173"></a><span class="co">## 51            1          0.00       0       1       0                  0.00                  0.00                  0.00</span></span>
<span id="cb13-174"><a href="#cb13-174"></a><span class="co">## 59            1          0.25       0       1       0                  0.00                  0.25                  0.00</span></span>
<span id="cb13-175"><a href="#cb13-175"></a><span class="co">## 67            1          0.50       0       1       0                  0.00                  0.50                  0.00</span></span>
<span id="cb13-176"><a href="#cb13-176"></a><span class="co">## 75            1          0.75       0       1       0                  0.00                  0.75                  0.00</span></span>
<span id="cb13-177"><a href="#cb13-177"></a><span class="co">## 83            1          1.00       0       1       0                  0.00                  1.00                  0.00</span></span>
<span id="cb13-178"><a href="#cb13-178"></a><span class="co">## 91            1          0.00       0       0       1                  0.00                  0.00                  0.00</span></span>
<span id="cb13-179"><a href="#cb13-179"></a><span class="co">## 96            1          0.54       0       0       1                  0.00                  0.00                  0.54</span></span>
<span id="cb13-180"><a href="#cb13-180"></a><span class="co">## 101           1          1.08       0       0       1                  0.00                  0.00                  1.08</span></span>
<span id="cb13-181"><a href="#cb13-181"></a><span class="co">## 106           1          1.62       0       0       1                  0.00                  0.00                  1.62</span></span>
<span id="cb13-182"><a href="#cb13-182"></a><span class="co">## 111           1          2.16       0       0       1                  0.00                  0.00                  2.16</span></span>
<span id="cb13-183"><a href="#cb13-183"></a></span>
<span id="cb13-184"><a href="#cb13-184"></a></span>
<span id="cb13-185"><a href="#cb13-185"></a></span>
<span id="cb13-186"><a href="#cb13-186"></a></span>
<span id="cb13-187"><a href="#cb13-187"></a><span class="co">## Mathematical model description:</span></span>
<span id="cb13-188"><a href="#cb13-188"></a></span>
<span id="cb13-189"><a href="#cb13-189"></a><span class="co"># Prop_surviving ~ Binomial(Ntot, P) </span></span>
<span id="cb13-190"><a href="#cb13-190"></a><span class="co"># log(P / (1-P)) = </span></span>
<span id="cb13-191"><a href="#cb13-191"></a><span class="co">#         1.43 - 3.80*Concentration </span></span>
<span id="cb13-192"><a href="#cb13-192"></a><span class="co">#         + 0.0085*fToxic2 + 0.014*fToxic3 + 0.27*fToxic4 </span></span>
<span id="cb13-193"><a href="#cb13-193"></a><span class="co">#         - 6.18*Concentration:fToxic2</span></span>
<span id="cb13-194"><a href="#cb13-194"></a><span class="co">#         - 1.90*Concentration*fToxic3 </span></span>
<span id="cb13-195"><a href="#cb13-195"></a><span class="co">#         + 1.48*Concentration*fToxic4</span></span>
<span id="cb13-196"><a href="#cb13-196"></a></span>
<span id="cb13-197"><a href="#cb13-197"></a><span class="co">## &quot;biological&quot; hypotheses:</span></span>
<span id="cb13-198"><a href="#cb13-198"></a></span>
<span id="cb13-199"><a href="#cb13-199"></a><span class="co"># (Intercept):     the mean (on the logit scale) for Toxic 1 when its</span></span>
<span id="cb13-200"><a href="#cb13-200"></a><span class="co"># concentration is 0 (null hypothesis not very useful, however</span></span>
<span id="cb13-201"><a href="#cb13-201"></a><span class="co"># the value is quite interesting, when back-transformed on the proportion</span></span>
<span id="cb13-202"><a href="#cb13-202"></a><span class="co"># scale: this is the proportion that survive the experiment in the absence</span></span>
<span id="cb13-203"><a href="#cb13-203"></a><span class="co"># of toxic chemical. Shouldn&#39;t differ between chemicals, presumably?)</span></span>
<span id="cb13-204"><a href="#cb13-204"></a></span>
<span id="cb13-205"><a href="#cb13-205"></a><span class="co"># Concentration: slope of Concentration, or change in survival per unit</span></span>
<span id="cb13-206"><a href="#cb13-206"></a><span class="co"># increase in Toxic 1 concentration (on logit link), or change in log-odds</span></span>
<span id="cb13-207"><a href="#cb13-207"></a><span class="co"># of survival (on proportion scale)</span></span>
<span id="cb13-208"><a href="#cb13-208"></a></span>
<span id="cb13-209"><a href="#cb13-209"></a><span class="co"># fToxic2:       difference between intercepts of Toxic 2 and Toxic 1</span></span>
<span id="cb13-210"><a href="#cb13-210"></a><span class="co"># fToxic3:       difference between intercepts of Toxic 3 and Toxic 1</span></span>
<span id="cb13-211"><a href="#cb13-211"></a><span class="co"># fToxic4:       difference between intercepts of Toxic 4 and Toxic 1</span></span>
<span id="cb13-212"><a href="#cb13-212"></a></span>
<span id="cb13-213"><a href="#cb13-213"></a><span class="co"># Concentration:fToxic2  difference between Conc. slopes for Toxic 2 and</span></span>
<span id="cb13-214"><a href="#cb13-214"></a><span class="co"># Toxic 1. Negative means a more lethal effect than Toxic 1</span></span>
<span id="cb13-215"><a href="#cb13-215"></a></span>
<span id="cb13-216"><a href="#cb13-216"></a><span class="co"># Concentration:fToxic3  difference between Conc. slopes for Toxic 2 and Toxic 1</span></span>
<span id="cb13-217"><a href="#cb13-217"></a><span class="co"># Concentration:fToxic4  difference between Conc. slopes for Toxic 2 and Toxic 1</span></span></code></pre></div>
<p> </p>
<p>6. Do you need to check for overdispersion? If so, how do you do it?</p>
<p> </p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># Yes, because this is a binomial variable with more than 1 trial per observation</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co"># Residual deviance: 117.67  on 107  degrees of freedom</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co"># -&gt; negligible overdispersion</span></span></code></pre></div>
<p> </p>
<p>7. Do you need to perform model selection? What is the final model?</p>
<p> </p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># we don&#39;t need to perform model selection here: given that the assay is</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co"># to compare the effect of different chemicals, the interaction alone is the</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co"># focus of the experiment. If it is not significant, we would have our answer</span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co"># and the simplified model wouldn&#39;t have much use.</span></span>
<span id="cb15-5"><a href="#cb15-5"></a></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="kw">drop1</span>(M1, <span class="dt">test=</span> <span class="st">&quot;Chi&quot;</span>)</span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co">## Single term deletions</span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">## </span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co">## Model:</span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">## cbind(Living_mites, Dead_mites) ~ Concentration * fToxic</span></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co">##                      Df Deviance    AIC    LRT  Pr(&gt;Chi)    </span></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="co">## &lt;none&gt;                    117.67 231.43                     </span></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="co">## Concentration:fToxic  3   145.86 253.62 28.189 3.315e-06 ***</span></span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="co">## ---</span></span>
<span id="cb15-15"><a href="#cb15-15"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb15-16"><a href="#cb15-16"></a></span>
<span id="cb15-17"><a href="#cb15-17"></a><span class="co"># interaction is significant: we can reject the null hypothesis that there is</span></span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="co"># no difference between  chemicals.</span></span></code></pre></div>
<p> </p>
<p>8. Perform model validation: are you satisfied with the model?</p>
<p> </p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">library</span>(car)</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="kw">vif</span>(M1)</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">##                          GVIF Df GVIF^(1/(2*Df))</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">## Concentration        10.00962  1        3.163798</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">## fToxic               18.28662  3        1.623139</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">## Concentration:fToxic 66.32618  3        2.011936</span></span>
<span id="cb16-7"><a href="#cb16-7"></a></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co"># extremely high VIF values: are they a problem?</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="co"># Not particularly:</span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="co"># The cause probably lies with the choice of the researchers to stop increasing</span></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="co"># the concentration when 100% mortality was reached (or close to), leading to</span></span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="co"># small sample size for high concentrations in the most potent chemicals.</span></span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="co"># Nevertheless their approach was sufficient to get decent estimates of the</span></span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="co"># curves for each treatment, with sufficient precision still to get significant</span></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="co"># differences. Adding more assays at higher concentrations (which presumably</span></span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="co"># would have yield close to 100% mortality as well), for the sake of getting a</span></span>
<span id="cb16-17"><a href="#cb16-17"></a><span class="co"># more balanced design would make little difference to the estimates.</span></span>
<span id="cb16-18"><a href="#cb16-18"></a></span>
<span id="cb16-19"><a href="#cb16-19"></a><span class="kw">par</span>(<span class="dt">mfrow=</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb16-20"><a href="#cb16-20"></a><span class="kw">plot</span>(M1)</span>
<span id="cb16-21"><a href="#cb16-21"></a></span>
<span id="cb16-22"><a href="#cb16-22"></a><span class="co"># a few complementary plots for info:</span></span>
<span id="cb16-23"><a href="#cb16-23"></a></span>
<span id="cb16-24"><a href="#cb16-24"></a><span class="co"># Pearson residuals</span></span>
<span id="cb16-25"><a href="#cb16-25"></a>E1&lt;-<span class="st"> </span><span class="kw">resid</span>(M1, <span class="dt">type=</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb16-26"><a href="#cb16-26"></a>F1&lt;-<span class="st"> </span><span class="kw">fitted</span>(M1)</span>
<span id="cb16-27"><a href="#cb16-27"></a><span class="kw">plot</span>(<span class="dt">x=</span> F1, <span class="dt">y=</span> E1, </span>
<span id="cb16-28"><a href="#cb16-28"></a>        <span class="dt">xlab=</span> <span class="st">&quot;Predicted values (probability scale)&quot;</span>, <span class="dt">ylab=</span> <span class="st">&quot;Pearson residuals&quot;</span>)</span>
<span id="cb16-29"><a href="#cb16-29"></a><span class="kw">abline</span>(<span class="dt">h=</span> <span class="dv">0</span>, <span class="dt">col=</span> <span class="kw">grey</span>(<span class="fl">0.5</span>), <span class="dt">lty=</span> <span class="dv">2</span>)</span>
<span id="cb16-30"><a href="#cb16-30"></a></span>
<span id="cb16-31"><a href="#cb16-31"></a><span class="co"># The Pearson residuals are quite different from the the raw or deviance residuals in this example,</span></span>
<span id="cb16-32"><a href="#cb16-32"></a><span class="co"># because when predicted values are small (near p=0), the variance of the binomial distribution is very</span></span>
<span id="cb16-33"><a href="#cb16-33"></a><span class="co"># small. Pearson residuals being the raw residuals (difference between observed and predicted) divided</span></span>
<span id="cb16-34"><a href="#cb16-34"></a><span class="co"># by the sqrt of the variance (a very small value), the Pearson residuals can thus be very large even</span></span>
<span id="cb16-35"><a href="#cb16-35"></a><span class="co"># if the raw residual isn&#39;t.</span></span>
<span id="cb16-36"><a href="#cb16-36"></a></span>
<span id="cb16-37"><a href="#cb16-37"></a><span class="co">#Independence</span></span>
<span id="cb16-38"><a href="#cb16-38"></a>E1&lt;-<span class="st"> </span><span class="kw">resid</span>(M1, <span class="dt">type=</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb16-39"><a href="#cb16-39"></a><span class="kw">plot</span>(<span class="dt">x=</span> <span class="kw">jitter</span>(Mites<span class="op">$</span>Concentration), <span class="dt">y=</span> <span class="kw">jitter</span>(E1), </span>
<span id="cb16-40"><a href="#cb16-40"></a>        <span class="dt">xlab=</span> <span class="st">&quot;Concentration&quot;</span>, <span class="dt">ylab=</span> <span class="st">&quot;Pearson residuals&quot;</span>)</span>
<span id="cb16-41"><a href="#cb16-41"></a><span class="kw">abline</span>(<span class="dt">h=</span> <span class="dv">0</span>, <span class="dt">col=</span> <span class="kw">grey</span>(<span class="fl">0.5</span>), <span class="dt">lty=</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="GLM_3_BinomialProportions_exercise_solutions_files/figure-html/Q8-1.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co"># Some trends in the residuals against concentration, suggesting that a straight</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="co"># line on the logit scale is not a perfect fit for these data. The model remains</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co"># good enough for its purpose of evidencing differences in the toxicity between</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="co"># chemicals</span></span></code></pre></div>
<p> </p>
<p>9. Obtain the fitted values from the model on the scale of the response, and plot to aid model interpretation. How do you interpret the results?</p>
<p> </p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>MyData1&lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Concentration=</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">2.16</span>, <span class="dt">length=</span> <span class="dv">50</span>), <span class="dt">fToxic=</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a>MyData2&lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Concentration=</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">2.16</span>, <span class="dt">length=</span> <span class="dv">50</span>), <span class="dt">fToxic=</span> <span class="st">&quot;2&quot;</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a>MyData3&lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Concentration=</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">2.16</span>, <span class="dt">length=</span> <span class="dv">50</span>), <span class="dt">fToxic=</span> <span class="st">&quot;3&quot;</span>)</span>
<span id="cb18-4"><a href="#cb18-4"></a>MyData4&lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Concentration=</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">2.16</span>, <span class="dt">length=</span> <span class="dv">50</span>), <span class="dt">fToxic=</span> <span class="st">&quot;4&quot;</span>)</span>
<span id="cb18-5"><a href="#cb18-5"></a></span>
<span id="cb18-6"><a href="#cb18-6"></a>P1&lt;-<span class="st"> </span><span class="kw">predict</span>(M1, <span class="dt">newdata=</span> MyData1, <span class="dt">type=</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb18-7"><a href="#cb18-7"></a>P2&lt;-<span class="st"> </span><span class="kw">predict</span>(M1, <span class="dt">newdata=</span> MyData2, <span class="dt">type=</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb18-8"><a href="#cb18-8"></a>P3&lt;-<span class="st"> </span><span class="kw">predict</span>(M1, <span class="dt">newdata=</span> MyData3, <span class="dt">type=</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb18-9"><a href="#cb18-9"></a>P4&lt;-<span class="st"> </span><span class="kw">predict</span>(M1, <span class="dt">newdata=</span> MyData4, <span class="dt">type=</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb18-10"><a href="#cb18-10"></a></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="kw">par</span>(<span class="dt">mfrow=</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)) <span class="co"># restore default 1x1 window</span></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="co"># to plot the proportion surviving, use 1 - proportion that died:</span></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="kw">plot</span>(<span class="dt">x=</span> <span class="kw">jitter</span>(Mites<span class="op">$</span>Concentration), <span class="dt">y=</span> <span class="kw">jitter</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>Mites<span class="op">$</span>Proportion), <span class="dt">pch=</span> <span class="dv">16</span>, <span class="dt">col=</span> Mites<span class="op">$</span>Toxic)</span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="kw">lines</span>(MyData1<span class="op">$</span>Concentration, P1, <span class="dt">col=</span> <span class="dv">1</span>, <span class="dt">lty=</span> <span class="dv">1</span>)</span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="kw">lines</span>(MyData2<span class="op">$</span>Concentration, P2, <span class="dt">col=</span> <span class="dv">2</span>, <span class="dt">lty=</span> <span class="dv">1</span>)</span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="kw">lines</span>(MyData3<span class="op">$</span>Concentration, P3, <span class="dt">col=</span> <span class="dv">3</span>, <span class="dt">lty=</span> <span class="dv">1</span>)</span>
<span id="cb18-17"><a href="#cb18-17"></a><span class="kw">lines</span>(MyData4<span class="op">$</span>Concentration, P4, <span class="dt">col=</span> <span class="dv">4</span>, <span class="dt">lty=</span> <span class="dv">1</span>)</span>
<span id="cb18-18"><a href="#cb18-18"></a></span>
<span id="cb18-19"><a href="#cb18-19"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </span>
<span id="cb18-20"><a href="#cb18-20"></a>            <span class="dt">legend=</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>), </span>
<span id="cb18-21"><a href="#cb18-21"></a>            <span class="dt">lty=</span> <span class="dv">1</span>, </span>
<span id="cb18-22"><a href="#cb18-22"></a>            <span class="dt">col=</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="dt">bty=</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="GLM_3_BinomialProportions_exercise_solutions_files/figure-html/Q9-1.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co"># All chemicals have a significant negative effect on the proportion of mites surviving, as their</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co"># concentration increases (to ascertain this you could relevel in hindsight the least powerful chemical</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co"># as the reference level, which will test whether its slope is significantly different from zero).</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co"># The Chem with the highest toxicity at lower concentrations is fToxic 2, followed by fToxic 3, 1</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co"># and 4 is the least potent.</span></span>
<span id="cb19-7"><a href="#cb19-7"></a></span>
<span id="cb19-8"><a href="#cb19-8"></a>Mites<span class="op">$</span>fToxic_4AsRef&lt;-<span class="st"> </span><span class="kw">relevel</span>(Mites<span class="op">$</span>fToxic, <span class="st">&quot;4&quot;</span>)</span>
<span id="cb19-9"><a href="#cb19-9"></a>M2&lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="kw">cbind</span>(Living_mites, Dead_mites) <span class="op">~</span><span class="st"> </span>Concentration <span class="op">+</span><span class="st"> </span>fToxic_4AsRef <span class="op">+</span><span class="st"> </span>Concentration <span class="op">:</span><span class="st"> </span>fToxic_4AsRef, <span class="dt">family=</span> binomial, <span class="dt">data=</span> Mites)</span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="kw">summary</span>(M2)</span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="co">## </span></span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="co">## Call:</span></span>
<span id="cb19-13"><a href="#cb19-13"></a><span class="co">## glm(formula = cbind(Living_mites, Dead_mites) ~ Concentration + </span></span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="co">##     fToxic_4AsRef + Concentration:fToxic_4AsRef, family = binomial, </span></span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="co">##     data = Mites)</span></span>
<span id="cb19-16"><a href="#cb19-16"></a><span class="co">## </span></span>
<span id="cb19-17"><a href="#cb19-17"></a><span class="co">## Deviance Residuals: </span></span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="co">##     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb19-19"><a href="#cb19-19"></a><span class="co">## -2.0569  -0.5875  -0.1295   0.7435   2.6011  </span></span>
<span id="cb19-20"><a href="#cb19-20"></a><span class="co">## </span></span>
<span id="cb19-21"><a href="#cb19-21"></a><span class="co">## Coefficients:</span></span>
<span id="cb19-22"><a href="#cb19-22"></a><span class="co">##                              Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb19-23"><a href="#cb19-23"></a><span class="co">## (Intercept)                    1.7087     0.4104   4.163 3.14e-05 ***</span></span>
<span id="cb19-24"><a href="#cb19-24"></a><span class="co">## Concentration                 -2.3183     0.4026  -5.758 8.52e-09 ***</span></span>
<span id="cb19-25"><a href="#cb19-25"></a><span class="co">## fToxic_4AsRef1                -0.2739     0.5848  -0.468 0.639594    </span></span>
<span id="cb19-26"><a href="#cb19-26"></a><span class="co">## fToxic_4AsRef2                -0.2653     0.5727  -0.463 0.643213    </span></span>
<span id="cb19-27"><a href="#cb19-27"></a><span class="co">## fToxic_4AsRef3                -0.2597     0.5828  -0.446 0.655886    </span></span>
<span id="cb19-28"><a href="#cb19-28"></a><span class="co">## Concentration:fToxic_4AsRef1  -1.4828     0.9630  -1.540 0.123626    </span></span>
<span id="cb19-29"><a href="#cb19-29"></a><span class="co">## Concentration:fToxic_4AsRef2  -7.6592     2.1524  -3.558 0.000373 ***</span></span>
<span id="cb19-30"><a href="#cb19-30"></a><span class="co">## Concentration:fToxic_4AsRef3  -3.3826     1.1189  -3.023 0.002502 ** </span></span>
<span id="cb19-31"><a href="#cb19-31"></a><span class="co">## ---</span></span>
<span id="cb19-32"><a href="#cb19-32"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb19-33"><a href="#cb19-33"></a><span class="co">## </span></span>
<span id="cb19-34"><a href="#cb19-34"></a><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb19-35"><a href="#cb19-35"></a><span class="co">## </span></span>
<span id="cb19-36"><a href="#cb19-36"></a><span class="co">##     Null deviance: 342.07  on 114  degrees of freedom</span></span>
<span id="cb19-37"><a href="#cb19-37"></a><span class="co">## Residual deviance: 117.67  on 107  degrees of freedom</span></span>
<span id="cb19-38"><a href="#cb19-38"></a><span class="co">## AIC: 231.43</span></span>
<span id="cb19-39"><a href="#cb19-39"></a><span class="co">## </span></span>
<span id="cb19-40"><a href="#cb19-40"></a><span class="co">## Number of Fisher Scoring iterations: 6</span></span>
<span id="cb19-41"><a href="#cb19-41"></a></span>
<span id="cb19-42"><a href="#cb19-42"></a><span class="co"># Concentration                 -2.3183     0.4026  -5.758 8.52e-09 ***</span></span>
<span id="cb19-43"><a href="#cb19-43"></a><span class="co"># shows that the negative dose-effect relationship (slope for concentration) is significant</span></span>
<span id="cb19-44"><a href="#cb19-44"></a><span class="co"># even for Toxic 4</span></span>
<span id="cb19-45"><a href="#cb19-45"></a></span>
<span id="cb19-46"><a href="#cb19-46"></a><span class="co"># Concentration:fToxic_4AsRef1  -1.4828     0.9630  -1.540 0.123626    </span></span>
<span id="cb19-47"><a href="#cb19-47"></a><span class="co"># Concentration:fToxic_4AsRef2  -7.6592     2.1524  -3.558 0.000373 ***</span></span>
<span id="cb19-48"><a href="#cb19-48"></a><span class="co"># Concentration:fToxic_4AsRef3  -3.3826     1.1189  -3.023 0.002502 ** </span></span>
<span id="cb19-49"><a href="#cb19-49"></a><span class="co"># these coefficients and their p-values show that only the dose-effect relationships of Toxics 2 and 3</span></span>
<span id="cb19-50"><a href="#cb19-50"></a><span class="co"># are significantly different from the dose-effect relationship of Toxic 4</span></span></code></pre></div>
<p> </p>
<p>10. (Optional) Include the 95 % CI on the plot above. You will need to obtain the fitted values and SE on the scale of the link function, calculate the CI and then back-transform.</p>
<p> </p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># Sketch model fit with 95% confidence bands for Toxic 1</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>MyData1&lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Concentration=</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">2.16</span>, <span class="dt">length=</span> <span class="dv">50</span>), <span class="dt">fToxic=</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a>MyData2&lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Concentration=</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">2.16</span>, <span class="dt">length=</span> <span class="dv">50</span>), <span class="dt">fToxic=</span> <span class="st">&quot;2&quot;</span>)</span>
<span id="cb20-4"><a href="#cb20-4"></a>MyData3&lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Concentration=</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">2.16</span>, <span class="dt">length=</span> <span class="dv">50</span>), <span class="dt">fToxic=</span> <span class="st">&quot;3&quot;</span>)</span>
<span id="cb20-5"><a href="#cb20-5"></a>MyData4&lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Concentration=</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">2.16</span>, <span class="dt">length=</span> <span class="dv">50</span>), <span class="dt">fToxic=</span> <span class="st">&quot;4&quot;</span>)</span>
<span id="cb20-6"><a href="#cb20-6"></a></span>
<span id="cb20-7"><a href="#cb20-7"></a>P1&lt;-<span class="st"> </span><span class="kw">predict</span>(M1, <span class="dt">newdata=</span> MyData1, <span class="dt">type=</span> <span class="st">&quot;link&quot;</span>, <span class="dt">se=</span> <span class="ot">TRUE</span>)</span>
<span id="cb20-8"><a href="#cb20-8"></a>P2&lt;-<span class="st"> </span><span class="kw">predict</span>(M1, <span class="dt">newdata=</span> MyData2, <span class="dt">type=</span> <span class="st">&quot;link&quot;</span>, <span class="dt">se=</span> <span class="ot">TRUE</span>)</span>
<span id="cb20-9"><a href="#cb20-9"></a>P3&lt;-<span class="st"> </span><span class="kw">predict</span>(M1, <span class="dt">newdata=</span> MyData3, <span class="dt">type=</span> <span class="st">&quot;link&quot;</span>, <span class="dt">se=</span> <span class="ot">TRUE</span>)</span>
<span id="cb20-10"><a href="#cb20-10"></a>P4&lt;-<span class="st"> </span><span class="kw">predict</span>(M1, <span class="dt">newdata=</span> MyData4, <span class="dt">type=</span> <span class="st">&quot;link&quot;</span>, <span class="dt">se=</span> <span class="ot">TRUE</span>)</span>
<span id="cb20-11"><a href="#cb20-11"></a></span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="kw">par</span>(<span class="dt">mfrow=</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)) <span class="co"># restore default 1x1 window</span></span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="kw">plot</span>(<span class="dt">x=</span> <span class="kw">jitter</span>(Mites<span class="op">$</span>Concentration, <span class="dv">10</span>), <span class="dt">y=</span> <span class="kw">jitter</span>(<span class="dv">1</span><span class="op">-</span>Mites<span class="op">$</span>Proportion, <span class="dv">2</span>), <span class="dt">pch=</span> <span class="dv">16</span>, <span class="dt">col=</span> Mites<span class="op">$</span>Toxic)</span>
<span id="cb20-14"><a href="#cb20-14"></a></span>
<span id="cb20-15"><a href="#cb20-15"></a>G1&lt;-<span class="st"> </span><span class="kw">exp</span>(P1<span class="op">$</span>fit) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(P1<span class="op">$</span>fit))</span>
<span id="cb20-16"><a href="#cb20-16"></a>G1.UP&lt;-<span class="st"> </span><span class="kw">exp</span>(P1<span class="op">$</span>fit <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>P1<span class="op">$</span>se.fit ) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(P1<span class="op">$</span>fit <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>P1<span class="op">$</span>se.fit))</span>
<span id="cb20-17"><a href="#cb20-17"></a>G1.LO&lt;-<span class="st"> </span><span class="kw">exp</span>(P1<span class="op">$</span>fit <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>P1<span class="op">$</span>se.fit) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(P1<span class="op">$</span>fit <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>P1<span class="op">$</span>se.fit))</span>
<span id="cb20-18"><a href="#cb20-18"></a></span>
<span id="cb20-19"><a href="#cb20-19"></a><span class="kw">lines</span>(MyData1<span class="op">$</span>Concentration, G1, <span class="dt">col=</span> <span class="dv">1</span>, <span class="dt">lty=</span> <span class="dv">1</span>)</span>
<span id="cb20-20"><a href="#cb20-20"></a><span class="kw">lines</span>(MyData1<span class="op">$</span>Concentration, G1.UP, <span class="dt">col=</span> <span class="dv">1</span>, <span class="dt">lty=</span> <span class="dv">2</span>)</span>
<span id="cb20-21"><a href="#cb20-21"></a><span class="kw">lines</span>(MyData1<span class="op">$</span>Concentration, G1.LO, <span class="dt">col=</span> <span class="dv">1</span>, <span class="dt">lty=</span> <span class="dv">2</span>)</span>
<span id="cb20-22"><a href="#cb20-22"></a></span>
<span id="cb20-23"><a href="#cb20-23"></a><span class="co"># repeat the example above for all &#39;Toxic&#39; levels (gets a bit busy on the graph)</span></span>
<span id="cb20-24"><a href="#cb20-24"></a></span>
<span id="cb20-25"><a href="#cb20-25"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, </span>
<span id="cb20-26"><a href="#cb20-26"></a>            <span class="dt">legend=</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>), </span>
<span id="cb20-27"><a href="#cb20-27"></a>            <span class="dt">lty=</span> <span class="dv">1</span>, </span>
<span id="cb20-28"><a href="#cb20-28"></a>            <span class="dt">col=</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="dt">bty=</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="GLM_3_BinomialProportions_exercise_solutions_files/figure-html/Q10-1.png" width="672" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="co"># Note how the confidence intervals are and should be asymmetrical on the response scale</span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="co"># (they are symmetrical on the link scale), and the logit link effectively</span></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="co"># prevents them from going below 0 or above 1</span></span></code></pre></div>
<p> </p>
<p>End of the Binomial (Proportions) GLM - mites survival</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
